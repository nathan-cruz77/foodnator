import Vuex from 'vuex'
import AppApi from '~apijs'

const store = () => new Vuex.Store({
  state: {
    cuisines: [],
    preferences: {
      price: 1,
      freeDelivery: false,
      selectedCuisines: [],
      rejectedCuisines: [],
      rating: 0,
    },
  },

  actions: {
    async fetchCuisines({ commit }) {
      const { data } = await AppApi.cuisines()
      commit('setCuisines', data)
    },

    updatePreferences({ commit, state }, preferences) {
      commit('setPreferences', preferences)

      if (state.logged_user) {
        AppApi.update_preferences(preferences)
      }
    }
  },

  mutations: {
    setCuisines(state, cuisines) {
      state.cuisines = cuisines
    },

    setPreferences(state, preferences) {
      state.preferences = preferences
    },
  },

  getters: {
    logged_user: ({ logged_user }) => logged_user,
    getPreferences: ({ preferences }) => preferences,
  },
})

export default store
